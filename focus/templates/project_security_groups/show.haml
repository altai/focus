-extends "projects_base.haml"
-from "_modals.haml" import show_modal with context
-from "_formhelpers.haml" import render_form_errors, render_h_field
-block content
  %div
    %h2
      {{ security_group.name }}: {{ security_group.description }}
    %h3
      Rules
    %div.container align="right"
      %a.btn.btn-primary href="{{url_for('.add_rule', security_group_id=security_group['id'])}}"
        Add
    %table.table.table-striped.table-bordered.table-condensed style="margin-top: 5px;"
       %thead
         %tr
           %th
             IP Protocol
           %th
             From Port
           %th
             To Port
           %th
             IP Range
           %th
             Source Group
           %th
             Actions
         -for robj in security_group_rules:
           %tr
             %td
               =robj[0].ip_protocol
             %td
               =robj[0].from_port
             %td
               =robj[0].to_port
             %td
               -if robj[0].ip_range:
                 =robj[0].ip_range.cidr
             %td
               -if robj[0].group:
                 =robj[0].group.name
             %td
               {{ show_modal(robj[1], action='delete', extra_fields=[delete_form.hidden_tag()], add_next=False, form_action=url_for('.delete_rule', security_group_id=security_group['id'], rule_id=robj[0]['id'])) }}

